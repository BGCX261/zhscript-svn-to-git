#summary oldj 的 HTML5 塔防游戏 的自制布局

= oldj 的 HTML5 塔防游戏 的自制布局 =
先从 https://github.com/oldj/html5-tower-defense 下载该游戏，解压后
{{{
cd oldj-html5-tower-defense-dac9b02/src/js
}}}
将下面的代码分别保存，各为

2.zs
{{{
#!/usr/bin/zhscript --。
加载mki.zs。

赋予纵格以（18）14。
赋予橫格以算术‘纵格’+3。
赋予纵格最大以算术‘纵格’-1。
赋予橫格最大以算术‘橫格’-1。
赋予区域宽以算术‘橫格’*32+5+120。
赋予区域高以算术‘纵格’*33+5+15。

赋予1以1。
赋予x以算术‘橫格最大’-1。
循环先
	如果‘x’小于1那么跳出。
	赋予x最大以算术‘橫格最大’-‘1’。
	赋予1以如果‘1’那么0否则1。
	赋予y最小以算术‘x’+1-(‘橫格’-‘纵格’)。
	显示x=‘x’;x最大=‘x最大’;y最小=‘y最小’↙。
	赋予y以算术‘纵格最大’-‘1’。
	循环先
		如果‘y’小于‘y最小’或者小于0那么跳出。
		显示y=‘y’。
		如果‘y’等于‘y最小’并且‘x最大’不等于‘x’那么先
			赋予x1以算术‘x’+1。
			循环先
				如果‘x1’大于‘x最大’那么跳出。
				赋予串以‘串’{pos:[‘x1’,‘y’],building:"wall"},。
				显示;‘x1’,‘y’。
				赋予x1以算术‘x1’+1。
			了。
		了否则先
			赋予串以‘串’{pos:[‘x’,‘y’],building:"wall"},。
			显示;‘x’,‘y’。
		了。
		显示↙。
		赋予y以算术‘y’-1。
	了。
	赋予串以‘串’↙。
	赋予x以算术‘x’-2。
了。

加载mko.zs。
}}}

mko.zs
{{{
加载lib/regexpr4。
赋予内容以调用‘type’、‘模板文件’。
调用‘正则攫’、‘内容’、
(.+“stage_main: ”\{[↙→]+“width: ”)([0-9]+)
([^↙]+[↙→]+“height: ”)([0-9]+)
(.+“map: ”\{[↙→]+“grid_x: ”)([0-9]+)
([^↙]+[↙→]+“grid_y: ”)([0-9]+)
(.+“exit: ”\[)([0-9]+)(“, ”)([0-9]+)
(.+“grids_cfg: ”\[[↙]+)(.+)
([→]+\][↙→]+\},[↙→]+“panel: \{.+ \+ TD.grid_size \* )”([0-9]+)
(.+)。
显示‘之2’/‘之4’/‘之6’/‘之8’/‘之10’/‘之12’/‘之16’/↙。
（显示‘串’↙。）
如果不存在区域宽那么
	赋予区域宽以‘之2’。
如果不存在区域高那么
	赋予区域高以‘之4’。
如果不存在橫格那么
	赋予橫格以‘之6’，赋予橫格最大以算术‘橫格’-1。
如果不存在纵格那么
	赋予纵格以‘之8’，赋予纵格最大以算术‘纵格’-1。
调用‘echo’、
‘之1’‘区域宽’‘之3’‘区域高’
‘之5’‘橫格’‘之7’‘纵格’
‘之9’‘橫格最大’‘之11’‘纵格最大’
‘之13’‘串’
‘之15’‘橫格’
‘之17’、
‘目标文件’。
}}}

mki.zs
{{{
加载lib/gjk4。
加载lib/defi。
加载lib/doscmd4。

赋予【上】目标文件以td-data-stage-1.js。
赋予【上】模板文件以‘目标文件’.tmpl。
如果调用‘exist’、‘模板文件’等于0那么
	执行显示“cp ‘目标文件’ ‘模板文件’”↙。
赋予【上】串以。
}}}

然后
{{{
chmod +x 2.zs
./2.zs
}}}
然后打开游戏，默认的布局便成为

http://zhscript.googlecode.com/svn/tmp/oldjhtml5td-1.png

了，最后给一战况

http://zhscript.googlecode.com/svn/tmp/oldjhtml5td-2.png

再最后，为什么名字是2.zs？因为之前还有个1.zs，就是个很简单的布局了

1.zs
{{{
#!/usr/bin/zhscript --。
加载mki.zs。

赋予1以1。
赋予x以1。
循环先
	如果‘x’大于等于15那么跳出。
	赋予最大以算术15-‘1’。
	显示x=‘x’;最大=‘最大’↙。
	赋予1以如果‘1’那么0否则1。
	赋予i以0。
	循环先
		如果‘i’大于‘最大’那么跳出。
		赋予串以‘串’{pos:[‘x’,先算术‘i’+‘1’了],building:"wall"},。
		赋予i以算术‘i’+1。
	了。
	赋予串以‘串’↙。
	赋予x以算术‘x’+2。
了。

加载mko.zs。
}}}

为玩得尽兴，建立chromium的应用程序快捷方式
{{{
/usr/bin/chromium-browser --app="file://你的存放路径/oldj-html5-tower-defense-dac9b02/src/td.html"
}}}